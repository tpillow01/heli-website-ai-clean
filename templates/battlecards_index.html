<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Battle Cards</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css', v=20) }}">
  <style>
    :root{ --cream:#f6efe3; --cream-2:#fbf6ee; --line:#e7dac6; --ink:#5e4b3f; --muted:#8a796d; --brand:#cc0000; }
    body{margin:0;background:repeating-linear-gradient(0deg,#f3eadc 0 28px,#f1e6d6 28px 29px);color:var(--ink)}
    .bc-top{position:sticky;top:0;z-index:10;background:rgba(255,255,255,.6);backdrop-filter:saturate(1.1) blur(6px);border-bottom:1px solid var(--line)}
    .bc-wrap{max-width:1200px;margin:0 auto;padding:18px}
    .brand{display:flex;justify-content:space-between;align-items:center}
    .brand .left{font-weight:900;color:#7e5140;letter-spacing:.02em}
    .brand .right{font-weight:900;color:#a9342a;letter-spacing:.08em}
    .tabs{display:flex;gap:16px;align-items:center;margin:10px 0 8px}
    .nav-link{background:transparent;border:none;padding:8px 0;color:var(--ink);font-weight:800;text-decoration:none;border-radius:6px;position:relative}
    .nav-link:hover{color:#3c2f28}
    .nav-link.active{color:#1f1713}
    .nav-link.active::after{content:"";position:absolute;left:0;bottom:-6px;width:24px;height:3px;border-radius:2px;background:var(--brand)}
    .search{display:flex;gap:10px;margin:14px 0 18px}
    .search input{flex:1;background:var(--cream-2);border:1px solid var(--line);border-radius:12px;padding:12px 14px;color:var(--ink)}
    .search button{background:#fff;border:1px solid var(--line);border-radius:12px;padding:12px 14px;font-weight:700;color:var(--ink)}
    .bc-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:18px}
    .card{background:var(--cream);border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 8px 26px rgba(93,69,49,.08), inset 0 1px 0 #fff8f0}
    .ser{color:#a15c48;font-weight:800;margin-bottom:6px}
    .ttl{margin:0 0 6px 0;color:#613f34;font-weight:900;line-height:1.15}
    .sub{color:var(--muted);font-size:.95rem;min-height:1.2em}
    .row{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
    .open{background:#fff;border:1px solid var(--line);border-radius:10px;padding:8px 12px;font-weight:700;color:#63463a;text-decoration:none}
    .chip{font-size:.85rem;background:#fff;border:1px dashed var(--line);border-radius:10px;padding:6px 10px;color:#7b6559}
  </style>
</head>
<body>
  <div class="bc-top">
    <div class="bc-wrap">
      <div class="brand">
        <div class="left">Tynan Equipment AI</div>
        <div class="right">HELI</div>
      </div>
      <nav class="tabs">
        <a href="/"            class="nav-link {{ 'active' if request.path == '/' else '' }}">Chat</a>
        <a href="/map"         class="nav-link {{ 'active' if request.path.startswith('/map') else '' }}">Map</a>
        <a href="/battlecards" class="nav-link {{ 'active' if request.path.startswith('/battlecards') else '' }}">Battle Cards</a>
      </nav>
    </div>
  </div>

  <main class="bc-wrap">
    <form class="search" action="/battlecards" method="get">
      <input name="q" value="{{ q or '' }}" placeholder="Search models, series, power, capacity…" />
      <button type="submit">Search</button>
    </form>

    <section class="bc-grid">
      {% for m in models %}
      <article class="card">
        {% if m.get('series') and m.get('series') != '—' %}
          <div class="ser">{{ m.get('series') }}</div>
        {% endif %}
        <h3 class="ttl">{{ m.get('model') or m.get('_display') }}</h3>
        <div class="sub">
          {% set p = m.get('power') %}
          {% set c = m.get('capacity') %}
          {% if p and p != '—' %}{{ p }}{% endif %}
          {% if p and p != '—' and c and 'Not specified' not in c %} · {% endif %}
          {% if c and 'Not specified' not in c %}{{ c }}{% endif %}
          {% if (not p or p == '—') and (not c or 'Not specified' in c) %}—{% endif %}
        </div>
        <div class="row">
          <a class="open" href="/battlecards/{{ m._slug }}">Open Card</a>
          {% if m.get('turning_radius') and 'Not specified' not in m.get('turning_radius') %}
            <div class="chip">Turning {{ m.get('turning_radius') }}</div>
          {% endif %}
        </div>
      </article>
      {% endfor %}
      {% if not models %}<p>No results.</p>{% endif %}
    </section>
  </main>
</body>
</html>
