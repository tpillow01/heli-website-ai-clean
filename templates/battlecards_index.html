<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Battle Cards</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css', v=43) }}">

  <style>
    :root{
      --cream:#f6efe3; --cream-2:#fbf6ee; --line:#e7dac6;
      --ink:#5e4b3f; --muted:#8a796d; --brand:#cc0000;
    }

    /* HARD RESET: some global CSS is making the body a flex container. */
    html, body { width: 100%; }
    body{
      display: block !important;
      justify-content: unset !important;
      align-items: unset !important;
      margin: 0;
      background: repeating-linear-gradient(0deg,#f3eadc 0 28px,#f1e6d6 28px 29px);
      color: var(--ink);
    }

    .bc-top{position:sticky;top:0;z-index:20;background:rgba(255,255,255,.6);backdrop-filter:saturate(1.1) blur(6px);border-bottom:1px solid var(--line)}
    .bc-wrap{max-width:1200px;margin:0 auto;padding:18px}
    .brand{display:flex;justify-content:space-between;align-items:center}
    .brand .left{font-weight:900;color:#7e5140;letter-spacing:.02em}
    .brand .right{font-weight:900;color:#a9342a;letter-spacing:.08em}

    .tabs{display:flex;gap:16px;align-items:center;margin:10px 0 8px}
    .nav-link{background:transparent;border:none;padding:8px 0;color:var(--ink);font-weight:800;text-decoration:none;border-radius:6px;position:relative}
    .nav-link:hover{color:#3c2f28}
    .nav-link.active{color:#1f1713}
    .nav-link.active::after{content:"";position:absolute;left:0;bottom:-6px;width:28px;height:3px;border-radius:2px;background:var(--brand)}

    .bc-search{display:flex;align-items:center;gap:10px;margin:16px 0 20px}
    .bc-search .field{flex:1;display:flex;align-items:center;gap:10px;background:var(--cream-2);border:1px solid var(--line);border-radius:14px;padding:12px 14px}
    .bc-search input{flex:1;border:0;outline:0;background:transparent;color:var(--ink);font-size:16px}
    .bc-search button{background:#fff;border:1px solid var(--line);border-radius:12px;padding:12px 14px;font-weight:700;color:var(--ink);cursor:pointer}

    /* FORCE a responsive grid layout */
    .bc-grid{
      display:grid !important;
      grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
      gap:22px;
      align-items:stretch;
    }

    .bc-card{
      background:var(--cream);border:1px solid var(--line);border-radius:18px;
      padding:16px;box-shadow:0 8px 26px rgba(93,69,49,.08), inset 0 1px 0 #fff8f0;
      display:flex;flex-direction:column;min-height:210px;
    }
    .bc-series{color:#a15c48;font-weight:800;margin:0 0 6px 0;font-size:.9rem;text-transform:uppercase;letter-spacing:.04em}
    .bc-title{margin:0 0 8px 0;color:#3b2a23;font-weight:900;line-height:1.15;font-size:24px}
    .bc-sub{color:var(--muted);font-size:.98rem;min-height:1.2em}

    .bc-footer{display:flex;gap:10px;justify-content:space-between;align-items:center;margin-top:auto}
    .bc-open{background:#fff;border:1px solid var(--line);border-radius:12px;padding:9px 14px;font-weight:800;color:#63463a;text-decoration:none;white-space:nowrap}
    .bc-chip{font-size:.9rem;background:#fff;border:1px dashed var(--line);border-radius:10px;padding:7px 10px;color:#7b6559;white-space:nowrap;max-width:60%;overflow:hidden;text-overflow:ellipsis}

    @media (max-width:640px){
      .bc-wrap{padding:14px}
      .bc-title{font-size:21px}
    }
  </style>
</head>
<body>
  <div class="bc-top">
    <div class="bc-wrap">
      <div class="brand">
        <div class="left">Tynan Equipment AI</div>
        <div class="right">HELI</div>
      </div>
      <nav class="tabs">
        <a href="/"            class="nav-link {{ 'active' if request.path == '/' else '' }}">Chat</a>
        <a href="/map"         class="nav-link {{ 'active' if request.path.startswith('/map') else '' }}">Map</a>
        <a href="/battlecards" class="nav-link {{ 'active' if request.path.startswith('/battlecards') else '' }}">Battle Cards</a>
      </nav>
    </div>
  </div>

  <main class="bc-wrap">
    <form class="bc-search" action="/battlecards" method="get">
      <div class="field">
        <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="#8a796d" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5Zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14Z"/></svg>
        <input name="q" value="{{ q or '' }}" placeholder="Search models, series, power, capacity…" />
      </div>
      <button type="submit">Search</button>
    </form>

    <section class="bc-grid">
      {% for m in models %}
      <article class="bc-card">
        {% if m.get('series') and m.get('series') != '—' %}
          <p class="bc-series">{{ m.get('series') }}</p>
        {% else %}
          <p class="bc-series">0 SERIES</p>
        {% endif %}

        <h3 class="bc-title">{{ m.get('model') or m.get('_display') }}</h3>

        <div class="bc-sub">
          {% set p = m.get('power') %}
          {% set c = m.get('capacity') %}
          {% if p and p != '—' %}{{ p }}{% endif %}
          {% if p and p != '—' and c and 'Not specified' not in c %} · {% endif %}
          {% if c and 'Not specified' not in c %}{{ c }}{% endif %}
          {% if (not p or p == '—') and (not c or 'Not specified' in c) %}—{% endif %}
        </div>

        <div class="bc-footer">
          <a class="bc-open" href="/battlecards/{{ m._slug }}">Open Card</a>
          {% if m.get('turning_radius') and 'Not specified' not in m.get('turning_radius') %}
            <div class="bc-chip">Turning {{ m.get('turning_radius') }}</div>
          {% endif %}
        </div>
      </article>
      {% endfor %}
      {% if not models %}<p>No results.</p>{% endif %}
    </section>
  </main>
</body>
</html>
